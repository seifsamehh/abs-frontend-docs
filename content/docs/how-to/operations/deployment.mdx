---
title: Deployment
description: Build, deploy, and monitor your applications in production
---

import { Card, Cards } from "fumadocs-ui/components/card";
import { Callout } from "fumadocs-ui/components/callout";
import { Tab, Tabs } from "fumadocs-ui/components/tabs";

# üöÄ Deployment

<Callout type="info">
  Learn how to build, deploy, and monitor your Next.js applications using Vercel
  and GitHub Actions.
</Callout>

## üèóÔ∏è Deployment Architecture

<Cards>
  <Card
    title="üåê Vercel"
    description="Primary hosting platform for Next.js applications"
  />
  <Card
    title="üîÑ GitHub Actions"
    description="CI/CD pipeline for automated deployments"
  />
  <Card
    title="üìä Vercel Analytics"
    description="Performance monitoring and user analytics"
  />
  <Card
    title="üîí Environment Variables"
    description="Secure configuration management"
  />
</Cards>

## üåç Environments

<Tabs items={["üõ†Ô∏è Development", "üß™ Staging", "üöÄ Production"]}>
  <Tab value="üõ†Ô∏è Development">
    - **URL**: `localhost:3000` - **Purpose**: Local development and testing -
    **Features**: Hot reload, debug tools, source maps - **Database**: Local
    development database
  </Tab>
  <Tab value="üß™ Staging">
    - **URL**: `staging.yourapp.com` - **Purpose**: Pre-production testing and
    validation - **Features**: Production-like environment, testing data -
    **Database**: Staging database with test data
  </Tab>
  <Tab value="üöÄ Production">
    - **URL**: `yourapp.com` - **Purpose**: Live application for end users -
    **Features**: Optimized builds, CDN, monitoring - **Database**: Production
    database with real data
  </Tab>
</Tabs>

## üõ†Ô∏è Build Process

### üíª Local Development

```bash
# Install dependencies
npm install

# Start development server
npm run dev

# Build for production
npm run build

# Start production server locally
npm run start

# Run tests
npm run test

# Run linting
npm run lint

# Run type checking
npm run type-check
```

### üè≠ Production Build

```bash
# Clean install (CI environment)
npm ci

# Run tests
npm run test:ci

# Build application
npm run build

# Verify build
npm run build:verify
```

## ‚ñ≤ Vercel Deployment

### Initial Setup

1. **Connect Repository**

   - Go to [vercel.com](https://vercel.com)
   - Import your GitHub repository
   - Vercel auto-detects Next.js

2. **Configure Project**

   ```json
   // vercel.json
   {
     "framework": "nextjs",
     "buildCommand": "npm run build",
     "outputDirectory": ".next",
     "installCommand": "npm ci"
   }
   ```

3. **Set Environment Variables**
   - Go to Project Settings ‚Üí Environment Variables
   - Add variables for each environment (Production, Preview, Development)

### Environment Variables

```bash
# Required variables
NEXT_PUBLIC_API_URL=https://api.yourapp.com
NEXTAUTH_SECRET=your-secret-key
NEXTAUTH_URL=https://yourapp.com

# Optional analytics
NEXT_PUBLIC_ANALYTICS_ID=your-analytics-id

# Database (if applicable)
DATABASE_URL=your-database-url
```

<Callout type="warn">
  Never commit sensitive environment variables to your repository. Use Vercel's
  environment variable management.
</Callout>

## üîÑ GitHub Actions CI/CD

### Workflow Configuration

```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

env:
  NODE_VERSION: "20"

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: "npm"
      - run: npm ci
      - run: npm run lint
      - run: npm run type-check

  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: "npm"
      - run: npm ci
      - run: npm run test:ci
      - uses: codecov/codecov-action@v3
        with:
          files: ./coverage/lcov.info

  build:
    runs-on: ubuntu-latest
    needs: [lint, test]
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: "npm"
      - run: npm ci
      - run: npm run build
      - uses: actions/upload-artifact@v4
        with:
          name: build
          path: .next

  e2e:
    runs-on: ubuntu-latest
    needs: build
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: "npm"
      - run: npm ci
      - run: npx playwright install --with-deps
      - run: npm run test:e2e
      - uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: playwright-report
          path: playwright-report
```

### Preview Deployments

Vercel automatically creates preview deployments for every pull request:

- Unique URL for each PR
- Automatic comments on PRs with preview links
- Environment variables from "Preview" environment

## üìä Monitoring & Analytics

### Vercel Analytics

```tsx
// src/app/layout.tsx
import { Analytics } from "@vercel/analytics/react";
import { SpeedInsights } from "@vercel/speed-insights/next";

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        <Analytics />
        <SpeedInsights />
      </body>
    </html>
  );
}
```

### Error Tracking

```tsx
// src/lib/error-tracking.ts
export function reportError(error: Error, context?: Record<string, unknown>) {
  // Log to console in development
  if (process.env.NODE_ENV === "development") {
    console.error(error, context);
    return;
  }

  // Send to error tracking service (e.g., Sentry)
  // Sentry.captureException(error, { extra: context });
}
```

### Health Checks

```tsx
// src/app/api/health/route.ts
import { NextResponse } from "next/server";

export async function GET() {
  try {
    // Check database connection
    // await db.query('SELECT 1');

    return NextResponse.json({
      status: "healthy",
      timestamp: new Date().toISOString(),
      version: process.env.NEXT_PUBLIC_APP_VERSION || "unknown",
    });
  } catch (error) {
    return NextResponse.json(
      { status: "unhealthy", error: "Database connection failed" },
      { status: 503 }
    );
  }
}
```

## ‚ö° Performance Optimization

### Build Optimization

```tsx
// next.config.mjs
/** @type {import('next').NextConfig} */
const nextConfig = {
  // Enable experimental features
  experimental: {
    optimizePackageImports: ["lucide-react", "@radix-ui/react-icons"],
  },

  // Image optimization
  images: {
    remotePatterns: [{ protocol: "https", hostname: "your-cdn.com" }],
    formats: ["image/avif", "image/webp"],
  },

  // Headers for caching
  async headers() {
    return [
      {
        source: "/:all*(svg|jpg|png|webp|avif)",
        headers: [
          {
            key: "Cache-Control",
            value: "public, max-age=31536000, immutable",
          },
        ],
      },
    ];
  },
};

export default nextConfig;
```

### Bundle Analysis

```bash
# Install analyzer
npm install -D @next/bundle-analyzer

# Add to next.config.mjs
import bundleAnalyzer from "@next/bundle-analyzer";

const withBundleAnalyzer = bundleAnalyzer({
  enabled: process.env.ANALYZE === "true",
});

export default withBundleAnalyzer(nextConfig);

# Run analysis
ANALYZE=true npm run build
```

## ‚Ü©Ô∏è Rollback Strategy

### üîÑ Vercel Rollbacks

1. Go to Vercel Dashboard ‚Üí Deployments
2. Find the previous stable deployment
3. Click "..." ‚Üí "Promote to Production"

### üîô Git Revert

```bash
# Revert last commit
git revert HEAD
git push origin main

# Revert to specific commit
git revert <commit-hash>
git push origin main
```

## ‚úÖ Deployment Checklist

<Callout type="info">
  Run through this checklist before every production deployment.
</Callout>

- [ ] All tests passing
- [ ] No TypeScript errors
- [ ] No linting errors
- [ ] Environment variables configured
- [ ] Database migrations run (if applicable)
- [ ] Feature flags configured
- [ ] Analytics tracking verified
- [ ] Error tracking configured
- [ ] Performance benchmarks met
- [ ] Security headers configured

## üëâ Next Steps

- üß™ [Testing Guide](/docs/guides/testing) - Ensure quality before deployment
- üîí [Security](/docs/reference/security) - Security best practices
- üìä [Monitoring](/docs/help/troubleshooting) - Debug production issues
