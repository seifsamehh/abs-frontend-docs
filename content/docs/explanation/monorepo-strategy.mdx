---
title: Monorepo Architecture
description: Our monorepo strategy, tools, and best practices for scalable frontend development
---

import { Card, Cards } from "fumadocs-ui/components/card";
import { Callout } from "fumadocs-ui/components/callout";
import { Tab, Tabs } from "fumadocs-ui/components/tabs";
import { Steps, Step } from "fumadocs-ui/components/steps";

# ğŸ¢ Monorepo Architecture

<Callout type="info">
  A **monorepo** is a single repository containing multiple distinct projects
  with well-defined relationships. At ABS, we use monorepos to share code,
  maintain consistency, and improve developer experience.
</Callout>

## Why Monorepo?

<Cards>
  <Card
    title="ğŸ“¦ Code Sharing"
    description="Share components, utilities, and types across all projects instantly"
  />
  <Card
    title="ğŸ”„ Atomic Changes"
    description="Make changes across multiple packages in a single PR"
  />
  <Card
    title="ğŸ› ï¸ Consistent Tooling"
    description="Same linting, testing, and build configuration everywhere"
  />
  <Card
    title="âš¡ Faster Onboarding"
    description="One repo to clone, one setup script to run"
  />
</Cards>

## Our Monorepo Structure

```
abs-frontend/
â”œâ”€â”€ apps/                           # Applications
â”‚   â”œâ”€â”€ web/                        # Main web application
â”‚   â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ next.config.ts
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ admin/                      # Admin dashboard
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ mobile/                     # React Native app (future)
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ docs/                       # Documentation site
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ packages/                       # Shared packages
â”‚   â”œâ”€â”€ ui/                         # Shared UI components
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ button/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ button.test.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ button.stories.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ card/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ input/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                     # Shared configurations
â”‚   â”‚   â”œâ”€â”€ eslint/
â”‚   â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚   â”œâ”€â”€ typescript/
â”‚   â”‚   â”‚   â”œâ”€â”€ base.json
â”‚   â”‚   â”‚   â”œâ”€â”€ nextjs.json
â”‚   â”‚   â”‚   â””â”€â”€ react-library.json
â”‚   â”‚   â”œâ”€â”€ tailwind/
â”‚   â”‚   â”‚   â””â”€â”€ tailwind.config.ts
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                      # Shared utilities
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ date.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ string.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ validation.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â”œâ”€â”€ api-client/                 # API client
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ endpoints/
â”‚   â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”‚
â”‚   â””â”€â”€ types/                      # Shared TypeScript types
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ user.ts
â”‚       â”‚   â”œâ”€â”€ api.ts
â”‚       â”‚   â””â”€â”€ index.ts
â”‚       â””â”€â”€ package.json
â”‚
â”œâ”€â”€ tooling/                        # Development tooling
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â”œâ”€â”€ setup.sh
â”‚   â”‚   â””â”€â”€ deploy.sh
â”‚   â””â”€â”€ templates/
â”‚       â”œâ”€â”€ component/
â”‚       â””â”€â”€ package/
â”‚
â”œâ”€â”€ turbo.json                      # Turborepo configuration
â”œâ”€â”€ pnpm-workspace.yaml             # pnpm workspace config
â”œâ”€â”€ package.json                    # Root package.json
â””â”€â”€ README.md
```

## Tool Choices

### Turborepo

We use **Turborepo** for build orchestration and caching.

<Tabs items={['ğŸ’¡ Why Turborepo', 'âš™ï¸ Configuration', 'ğŸ–¥ï¸ Commands']}>
  <Tab value="ğŸ’¡ Why Turborepo">
**Benefits:**
- âš¡ **Remote Caching** - Never rebuild what hasn't changed
- ğŸ”€ **Parallel Execution** - Run tasks across packages simultaneously  
- ğŸ“Š **Task Graphs** - Intelligent dependency ordering
- ğŸ¯ **Incremental Builds** - Only rebuild affected packages
- ğŸ”§ **Simple Config** - Works with existing package.json scripts

**Performance Gains:**

- 10x faster CI builds with caching
- Parallel lint/test/build
- Shared caches across team members

</Tab>
<Tab value="âš™ï¸ Configuration">
```json title="turbo.json"
{
  "$schema": "https://turbo.build/schema.json",
  "globalDependencies": ["**/.env.*local"],
  "globalEnv": ["NODE_ENV", "VERCEL_URL"],
  "tasks": {
    "build": {
      "dependsOn": ["^build"],
      "outputs": [".next/**", "!.next/cache/**", "dist/**"]
    },
    "lint": {
      "dependsOn": ["^lint"]
    },
    "test": {
      "dependsOn": ["^build"],
      "outputs": ["coverage/**"]
    },
    "dev": {
      "cache": false,
      "persistent": true
    },
    "type-check": {
      "dependsOn": ["^build"]
    },
    "clean": {
      "cache": false
    }
  }
}
```
</Tab>
  <Tab value="ğŸ–¥ï¸ Commands">
```bash
# Run all builds
pnpm turbo build

# Build specific app

pnpm turbo build --filter=web

# Build app and its dependencies

pnpm turbo build --filter=web...

# Run dev for specific app

pnpm turbo dev --filter=web

# Run tests affected by changes

pnpm turbo test --filter=...[origin/main]

# View dependency graph

pnpm turbo build --graph

# Clear cache

pnpm turbo clean

````
</Tab>
</Tabs>

### pnpm Workspaces

We use **pnpm** for package management with workspaces.

```yaml title="pnpm-workspace.yaml"
packages:
  - 'apps/*'
  - 'packages/*'
  - 'tooling/*'
````

```json title="package.json (root)"
{
  "name": "abs-frontend",
  "private": true,
  "scripts": {
    "build": "turbo build",
    "dev": "turbo dev",
    "lint": "turbo lint",
    "test": "turbo test",
    "type-check": "turbo type-check",
    "clean": "turbo clean && rm -rf node_modules",
    "format": "prettier --write \"**/*.{ts,tsx,md,json}\"",
    "prepare": "husky"
  },
  "devDependencies": {
    "turbo": "^2.0.0",
    "prettier": "^3.0.0",
    "husky": "^9.0.0"
  },
  "packageManager": "pnpm@9.0.0",
  "engines": {
    "node": ">=20",
    "pnpm": ">=9"
  }
}
```

## Creating Packages

### UI Package Example

<Steps>
  <Step>
    ### Initialize Package
    
```bash
mkdir -p packages/ui/src/components
cd packages/ui
pnpm init
```
</Step>
  <Step>
    ### Configure package.json
    
```json title="packages/ui/package.json"
{
  "name": "@abs/ui",
  "version": "0.0.0",
  "private": true,
  "main": "./src/index.ts",
  "types": "./src/index.ts",
  "exports": {
    ".": "./src/index.ts",
    "./button": "./src/components/button/index.ts",
    "./card": "./src/components/card/index.ts"
  },
  "scripts": {
    "lint": "eslint src/",
    "type-check": "tsc --noEmit"
  },
  "dependencies": {
    "class-variance-authority": "^0.7.0",
    "clsx": "^2.0.0"
  },
  "peerDependencies": {
    "react": "^18.0.0",
    "react-dom": "^18.0.0"
  },
  "devDependencies": {
    "@abs/config": "workspace:*",
    "typescript": "^5.0.0"
  }
}
```
</Step>
  <Step>
    ### Create a Component
    
```tsx title="packages/ui/src/components/button/button.tsx"
import { forwardRef } from 'react';
import { cva, type VariantProps } from 'class-variance-authority';
import { cn } from '../../utils';

const buttonVariants = cva(
'inline-flex items-center justify-center rounded-md font-medium transition-colors',
{
variants: {
variant: {
default: 'bg-primary text-primary-foreground hover:bg-primary/90',
outline: 'border border-input bg-background hover:bg-accent',
ghost: 'hover:bg-accent hover:text-accent-foreground',
},
size: {
default: 'h-10 px-4 py-2',
sm: 'h-9 px-3',
lg: 'h-11 px-8',
},
},
defaultVariants: {
variant: 'default',
size: 'default',
},
}
);

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {}

const Button = forwardRef<HTMLButtonElement, ButtonProps>(
({ className, variant, size, ...props }, ref) => {
return (

<button
  className={cn(buttonVariants({ variant, size, className }))}
  ref={ref}
  {...props}
/>
); } ); Button.displayName = 'Button';

export { Button, buttonVariants };
```
</Step>
  <Step>
    ### Export from Package
    
```ts title="packages/ui/src/index.ts"
export * from './components/button';
export * from './components/card';
// ... other exports
```
</Step>
  <Step>
    ### Use in Apps
    
```tsx title="apps/web/app/page.tsx"
import { Button } from '@abs/ui/button';

export default function HomePage() {
  return (
    <div>
      <Button variant="default">Click me</Button>
      <Button variant="outline">Outline</Button>
    </div>
  );
}
```
</Step>
</Steps>

## Dependency Management

### Internal Dependencies

Reference internal packages using `workspace:*`:

```json
{
  "dependencies": {
    "@abs/ui": "workspace:*",
    "@abs/utils": "workspace:*",
    "@abs/types": "workspace:*"
  }
}
```

### Shared Dependencies

Keep versions consistent across packages. Update the root `package.json` or use pnpm's `overrides`:

```json title="package.json (root)"
{
  "pnpm": {
    "overrides": {
      "react": "^18.3.0",
      "react-dom": "^18.3.0",
      "typescript": "^5.5.0"
    }
  }
}
```

## Best Practices

<Cards>
  <Card
    title="ğŸ“¦ Small, Focused Packages"
    description="Each package should have a single responsibility"
  />
  <Card
    title="ğŸ”’ Explicit Exports"
    description="Use package.json exports field to control public API"
  />
  <Card
    title="ğŸ§ª Test in Isolation"
    description="Each package should have its own tests"
  />
  <Card
    title="ğŸ“ Document Everything"
    description="README in each package explaining its purpose"
  />
</Cards>

### Package README Template

```markdown title="packages/ui/README.md"
# @abs/ui

Shared UI components for ABS applications.

## Installation

This package is internal and automatically available in the monorepo.

## Usage

\`\`\`tsx
import { Button } from '@abs/ui/button';
import { Card } from '@abs/ui/card';
\`\`\`

## Components

- `Button` - Primary action button with variants
- `Card` - Container component for content
- `Input` - Form input with validation states

## Development

\`\`\`bash

# Run storybook

pnpm --filter @abs/ui storybook

# Run tests

pnpm --filter @abs/ui test
\`\`\`
```

## CI/CD Integration

### GitHub Actions with Turborepo

```yaml title=".github/workflows/ci.yml"
name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

env:
  TURBO_TOKEN: ${{ secrets.TURBO_TOKEN }}
  TURBO_TEAM: ${{ vars.TURBO_TEAM }}

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: pnpm/action-setup@v3
        with:
          version: 9

      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: "pnpm"

      - run: pnpm install --frozen-lockfile

      - run: pnpm turbo build lint test type-check
```

<Callout type="tip">
  **Remote Caching:** Connect Turborepo to Vercel for remote caching. This
  shares build caches across CI runs and team members, dramatically speeding up
  builds.
</Callout>

## Migration Guide

Moving from multiple repos to a monorepo? Here's the process:

<Steps>
  <Step>
    ### Set Up the Monorepo Structure Create the folder structure and install
    Turborepo/pnpm.
  </Step>
  <Step>
    ### Move Apps One by One Start with the smallest app. Copy code, update
    imports, verify it builds.
  </Step>
  <Step>
    ### Extract Shared Code Identify code that's duplicated across apps and move
    to packages.
  </Step>
  <Step>### Update CI/CD Configure new pipelines with Turborepo caching.</Step>
  <Step>
    ### Train the Team Document the new workflow and hold a team session.
  </Step>
</Steps>

## Resources

<Cards>
  <Card
    title="ğŸ“– Turborepo Docs"
    href="https://turbo.build/repo/docs"
    description="Official Turborepo documentation"
  />
  <Card
    title="ğŸ“¦ pnpm Workspaces"
    href="https://pnpm.io/workspaces"
    description="pnpm workspace documentation"
  />
  <Card
    title="ğŸ“ Monorepo Tools"
    href="https://monorepo.tools"
    description="Compare monorepo tools and learn best practices"
  />
</Cards>
